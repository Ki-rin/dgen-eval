f"Extract a short list of key requirements that the Model Risk Management Validator " 
f"expects in the {section_cell.value} section of the low-risk model documentation, " 
f"focusing on the sub-sub-section written by the developer about {question_cell.value}."
----

section: "4. Hallucination Rate"
description: "Evaluate if the output includes fabricated or irrelevant information unrelated to the question or MRM requirements."
prompt: |
  Evaluate the output for hallucination based on the question and MRM requirements.

  **Output:** {output}  
  **Question:** {question}

  Assume the output was generated using context not provided here. Your task is to detect:
  - Fabricated information.
  - Information unrelated to the question or MRM requirements.
  - Contradictions or details that cannot align with the question.

  **MRM Requirements:**  
  - {requirements}

  **Evaluation Criteria:**
  - Does the output include information that is fabricated or unrelated to the question or MRM requirements?
  - Does the output include contradictions or details that cannot logically align with the question?

  **Provide:**
  - **Score:**
    - "0" if the output aligns with the question and MRM requirements, assuming reasonable context.
    - "1" if the output includes hallucinations (e.g., fabricated, irrelevant, or incorrect details).
  - **Comment:** Briefly explain the score, pointing out any hallucinations.

  Note: Focus only on clear and major issues. Ignore minor inaccuracies.



evaluation_prompts:
  - section: "1. Coherence/Clarity"
    description: "Evaluate if the output is clear, easy to understand, and maintains a logical flow."
    prompt: |
      Evaluate the following output for coherence and clarity:
      Output: {output}
      Criteria:
        - Does the output maintain a clear logical flow?
        - Is it easy to understand?
      Provide:
        - **Score**:
          - "1" if the output is clear and logically structured.
          - "0.5" if it lacks understandability OR the logical flow is flawed.
          - "0" if it lacks understandability AND logical flow is flawed.
        - **Comment**: Provide a concise explanation for your score, highlighting examples where clarity or logical flow is strong or weak.

  - section: "2. Quality Rate"
    description: "Evaluate the degree to which the output provides value in addressing MRM requirements."
    prompt: |
      Evaluate the following output for quality:
      Output: {output}
      MRM requirements are as follows:
      - {requirements}
      Criteria:
        - Does the information present address (at least partially) the MRM requirements?
      Provide:
        - **Score**:
          - "1" if the output fully addresses the requirements.
          - "0.5" if it partially addresses requirements but needs adaptation or improvement.
          - "0" if it does not address the requirements at all.
        - **Comment**: Provide a concise explanation for your score, referencing specific MRM requirements as necessary.

  - section: "3. Capture Rate"
    description: "Calculate the percentage of requested key items included in the output."
    prompt: |
      Evaluate the capture rate for the following output:
      Output: {output}
      MRM requirements are as follows:
      - {requirements}
      Criteria to evaluate the capture rate:
        - Identify the total number of requirements (req_total).
        - Identify the number of requirements met in the output (req_output).
        - Calculate Capture Rate as req_output / req_total.
      Provide:
        - **Score**: Provide the calculated capture rate (0.00 to 1.00).
        - **Comment**: Provide a concise explanation for your score, identifying any missing or insufficiently addressed requirements.

  - section: "4. Hallucination Rate"
    description: "Evaluate whether the output contains information irrelevant to MRM requirements, question, or guidelines."
    prompt: |
      Evaluate the following output for hallucination:
      Question: {question}
      Guidelines: {guidelines}
      Output: {output}
      MRM requirements are as follows:
      - {requirements}
      Criteria:
        - Does the output introduce information that is clearly irrelevant, fabricated, or unsupported by the question, guidelines, or MRM requirements?
        - Assume the output may have leveraged general or project-specific context unless it explicitly contradicts MRM relevance.
      Provide:
        - **Score**:
          - "0" if the output plausibly aligns with the question, guidelines, or MRM requirements.
          - "1" if the output demonstrably includes irrelevant, fabricated, or unsupported information that cannot be justified by any reasonable MRM context.
        - **Comment**: Provide a concise explanation for your score, identifying specific content that is irrelevant or unsupported by the MRM requirements or question/guidelines.
